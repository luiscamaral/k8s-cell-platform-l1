# Karpenter for Proxmox - Kustomization
# Manages all Karpenter resources for L1 Platform
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Resources are applied in order
resources:
  # ExternalSecrets (pull from Vault via ESO)
  - externalsecret-proxmox-credentials.yaml
  - externalsecret-talos-values.yaml
  # Talos template (Go template, not actual secrets)
  - secret-talos-template.yaml
  # Karpenter CRDs (must exist before controller)
  - proxmox-unmanaged-template.yaml
  - proxmox-nodeclass.yaml
  - nodepool-burst.yaml

# Common labels for all resources
commonLabels:
  app.kubernetes.io/part-of: kubernetes-cell-platform
  app.kubernetes.io/managed-by: kustomize
  platform-layer: l1